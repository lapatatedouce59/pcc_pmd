<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ooo</title>
    <style>
        body{
            margin: 0;
        }

        .voy{
            color: white;
            background-color: #8B8B8B;
        }
        .ok{
            background-color: #00EF35;
        }
        .alarm{
            background-color: #EF0000;
        }
        .tco{
            background-color: #1C1C1C;
            height: calc(1730px/4);
            width: calc(7203px/4);
        }
    </style>
</head>
<body>
    <!--<object data="./src/pltp/img/all.svg" type="" id="pltp" style="width: 100%;"></object>-->
    <span><button id="btnACQU">ACQUITTER</button></span>
    <br>
    <span id="voyGAT" class="voy">GAT</span>
    <span id="voyABS" class="voy">ABS</span>
    <span><button id="btnAG">AG</button></span>
    <span><button id="btnAG2">r√©tablir</button></span>
    <span> <input type="checkbox" id="comForceHT" class="com"> Forcage HT </span>
    <br>
    <span id="voyUCAV1" class="voy">UCA V1</span>
    <span id="voyUCAV2" class="voy">UCA V2</span>
    <span> <input type="checkbox" id="comAuthV1" checked class="com"> AUTHV1 </span>
    <span> <input type="checkbox" id="comAuthV2" checked class="com"> AUTHV2 </span>
    <span id="voyHTV1" class="voy">HT V1</span>
    <span id="voyHTV2" class="voy">HT V2</span>
    <span> <input type="checkbox" id="comFSLine" class="com"> COUPURE FS </span>
    <span id="voyALC" class="voy">ALC</span>
    <span id="voyFSV1" class="voy">FS V1</span>
    <span id="voyFSV2" class="voy">FS V2</span>
    <br>
    <span id="voyUCAGAT" class="voy">UCA</span>
    <span> <input type="checkbox" id="comAuthGAT" class="com" checked> AUTH </span>
    <span id="voyHTGAT" class="voy">HT</span>
    <span> <input type="checkbox" id="comFSGAT" class="com"> COUPURE FS </span>
    <span id="voyFSGAT" class="voy">FS</span>
    <br>
    <span> <input type="checkbox" id="comArmPR" class="com" checked> Armt. PR </span>
    <br>
    <span id="voyCC" class="voy">CC</span>
    <span id="voyPAL" class="voy">PAL</span>
    <span id="voyAQU" class="voy">AQU</span>
    <br>
    <span> <input type="checkbox" id="comInhibUCA" class="com"> Inhib. UCA </span>
    <br>
    <span> <input type="checkbox" id="comIDPOTPAS" class="com"> IDPO tout PAS </span>
    <br>
    <h3>SS</h3>
    <span id="voyAlimSS04" class="voy">ALIM</span>
    <span id="voyDHTSS04" class="voy">DHT</span>
    <span id="voyDISS04" class="voy">DI</span>
    <select name="SS04" id="comStateSS04">
        <option value="0">0</option>
        <option value="YES">OUI</option>
        <option value="NON">NON</option>
    </select> <span>SS04</span>
    <br>
    <span id="voyAlimSS05" class="voy">ALIM</span>
    <span id="voyDHTSS05" class="voy">DHT</span>
    <span id="voyDISS05" class="voy">DI</span>
    <select name="SS04" id="comStateSS05">
        <option value="0">0</option>
        <option value="YES">OUI</option>
        <option value="NON">NON</option>
    </select> <span>SS05</span>
    <br>
    <span id="voyAlimSS06" class="voy">ALIM</span>
    <span id="voyDHTSS06" class="voy">DHT</span>
    <span id="voyDISS06" class="voy">DI</span>
    <select name="SS04" id="comStateSS06">
        <option value="0">0</option>
        <option value="YES">OUI</option>
        <option value="NON">NON</option>
    </select> <span>SS06</span>
    <br>
    <span id="voyAlimSS07" class="voy">ALIM</span>
    <span id="voyDHTSS07" class="voy">DHT</span>
    <span id="voyDISS07" class="voy">DI</span>
    <select name="SS04" id="comStateSS07">
        <option value="0">0</option>
        <option value="YES">OUI</option>
        <option value="NON">NON</option>
    </select> <span>SS07</span>
    <br>
    <span id="voyAlimSS08" class="voy">ALIM</span>
    <span id="voyDHTSS08" class="voy">DHT</span>
    <span id="voyDISS08" class="voy">DI</span>
    <select name="SS04" id="comStateSS08">
        <option value="0">0</option>
        <option value="YES">OUI</option>
        <option value="NON">NON</option>
    </select> <span>SS08</span>
    <br>
    <span id="voyAlimSS09" class="voy">ALIM</span>
    <span id="voyDHTSS09" class="voy">DHT</span>
    <span id="voyDISS09" class="voy">DI</span>
    <select name="SS04" id="comStateSS09">
        <option value="0">0</option>
        <option value="YES">OUI</option>
        <option value="NON">NON</option>
    </select> <span>SS09</span>
    <br>
    <span id="voyAlimSS10" class="voy">ALIM</span>
    <span id="voyDHTSS10" class="voy">DHT</span>
    <span id="voyDISS10" class="voy">DI</span>
    <select name="SS04" id="comStateSS10">
        <option value="0">0</option>
        <option value="YES">OUI</option>
        <option value="NON">NON</option>
    </select> <span>SS10</span>
    <br>
    <span id="voyAlimSS11" class="voy">ALIM</span>
    <span id="voyDHTSS11" class="voy">DHT</span>
    <span id="voyDISS11" class="voy">DI</span>
    <select name="SS04" id="comStateSS11">
        <option value="0">0</option>
        <option value="YES">OUI</option>
        <option value="NON">NON</option>
    </select> <span>SS11</span>
    <br>
    <span id="voyAlimSS12" class="voy">ALIM</span>
    <span id="voyDHTSS12" class="voy">DHT</span>
    <span id="voyDISS12" class="voy">DI</span>
    <select name="SS04" id="comStateSS12">
        <option value="0">0</option>
        <option value="YES">OUI</option>
        <option value="NON">NON</option>
    </select> <span>SS12</span>
    <br>
    <span id="voyAlimSS13" class="voy">ALIM</span>
    <span id="voyDHTSS13" class="voy">DHT</span>
    <span id="voyDISS13" class="voy">DI</span>
    <select name="SS04" id="comStateSS13">
        <option value="0">0</option>
        <option value="YES">OUI</option>
        <option value="NON">NON</option>
    </select> <span>SS13</span>
    <br>
    <span id="voyAlimSS14" class="voy">ALIM</span>
    <span id="voyDHTSS14" class="voy">DHT</span>
    <span id="voyDISS14" class="voy">DI</span>
    <select name="SS04" id="comStateSS14">
        <option value="0">0</option>
        <option value="YES">OUI</option>
        <option value="NON">NON</option>
    </select> <span>SS14</span>
    <br>
    <span id="voyAlimSS15" class="voy">ALIM</span>
    <span id="voyDHTSS15" class="voy">DHT</span>
    <span id="voyDISS15" class="voy">DI</span>
    <select name="SS04" id="comStateSS15">
        <option value="0">0</option>
        <option value="YES">OUI</option>
        <option value="NON">NON</option>
    </select> <span>SS15</span>
    <br>
    <div class="tco">
        <div class="ligne">
            <object data="src/tco/pa/SECTION1.svg" type="image/svg+xml" id="s1svg"></object>
        </div>
        <button id="forward">AVANCER</button>
        <button id="downward">RECULER</button>
        <input type="text" id="trainAffect" placeholder="train">
        <button id="experiment">EXPERIENCE</button>
    </div>
    <script type="module">

        let voyGAT = document.getElementById('voyGAT')
        let voyABS = document.getElementById('voyABS')
        let voyUCAV1 = document.getElementById('voyUCAV1')
        let voyUCAV2 = document.getElementById('voyUCAV2')
        let voyHTV1 = document.getElementById('voyHTV1')
        let voyHTV2 = document.getElementById('voyHTV2')
        let voyALC = document.getElementById('voyALC')
        let voyFSV1 = document.getElementById('voyFSV1')
        let voyFSV2 = document.getElementById('voyFSV2')
        let voyUCAGAT = document.getElementById('voyUCAGAT')
        let voyHTGAT = document.getElementById('voyHTGAT')
        let voyFSGAT = document.getElementById('voyFSGAT')
        let voyCC = document.getElementById('voyCC')
        let voyPAL = document.getElementById('voyPAL')
        let voyAQU = document.getElementById('voyAQU')
        let voyAlimSS04 = document.getElementById('voyAlimSS04')
        let voyDHTSS04 = document.getElementById('voyDHTSS04')
        let voyDISS04 = document.getElementById('voyDISS04')
        let voyAlimSS05 = document.getElementById('voyAlimSS05')
        let voyDHTSS05 = document.getElementById('voyDHTSS05')
        let voyDISS05 = document.getElementById('voyDISS05')
        let voyAlimSS06 = document.getElementById('voyAlimSS06')
        let voyDHTSS06 = document.getElementById('voyDHTSS06')
        let voyDISS06 = document.getElementById('voyDISS06')
        let voyAlimSS07 = document.getElementById('voyAlimSS07')
        let voyDHTSS07 = document.getElementById('voyDHTSS07')
        let voyDISS07 = document.getElementById('voyDISS07')
        let voyAlimSS08 = document.getElementById('voyAlimSS08')
        let voyDHTSS08 = document.getElementById('voyDHTSS08')
        let voyDISS08 = document.getElementById('voyDISS08')
        let voyAlimSS09 = document.getElementById('voyAlimSS09')
        let voyDHTSS09 = document.getElementById('voyDHTSS09')
        let voyDISS09 = document.getElementById('voyDISS09')
        let voyAlimSS10 = document.getElementById('voyAlimSS10')
        let voyDHTSS10 = document.getElementById('voyDHTSS10')
        let voyDISS10 = document.getElementById('voyDISS10')
        let voyAlimSS11 = document.getElementById('voyAlimSS11')
        let voyDHTSS11 = document.getElementById('voyDHTSS11')
        let voyDISS11 = document.getElementById('voyDISS11')
        let voyAlimSS12 = document.getElementById('voyAlimSS12')
        let voyDHTSS12 = document.getElementById('voyDHTSS12')
        let voyDISS12 = document.getElementById('voyDISS12')
        let voyAlimSS13 = document.getElementById('voyAlimSS13')
        let voyDHTSS13 = document.getElementById('voyDHTSS13')
        let voyDISS13 = document.getElementById('voyDISS13')
        let voyAlimSS14 = document.getElementById('voyAlimSS14')
        let voyDHTSS14 = document.getElementById('voyDHTSS14')
        let voyDISS14 = document.getElementById('voyDISS14')
        let voyAlimSS15 = document.getElementById('voyAlimSS15')
        let voyDHTSS15 = document.getElementById('voyDHTSS15')
        let voyDISS15 = document.getElementById('voyDISS15')

        let btnACQU = document.getElementById('btnACQU')
        let btnAG = document.getElementById('btnAG')
        let btnAG2 = document.getElementById('btnAG2')

        let comForceHT = document.getElementById('comForceHT')
        let comAuthV1 = document.getElementById('comAuthV1')
        let comAuthV2 = document.getElementById('comAuthV2')
        let comFSLine = document.getElementById('comFSLine')
        let comAuthGAT = document.getElementById('comAuthGAT')
        let comFSGAT = document.getElementById('comFSGAT')
        let comArmPR = document.getElementById('comArmPR')
        let comInhibUCA = document.getElementById('comInhibUCA')
        let comIDPOTPAS = document.getElementById('comIDPOTPAS')

        let trainAffect = document.getElementById('trainAffect')
        let btnForward = document.getElementById('forward')
        let btnDownward = document.getElementById('downward')
        let btnExp = document.getElementById('experiment')

        let cantons = false
        
        let S1 = document.getElementById('s1svg')
        S1.addEventListener('load', ()=>{
            let s1svgDoc = S1.contentDocument;
            cantons = {
            1: s1svgDoc.getElementById('1'),
            2: s1svgDoc.getElementById('2'),
            3: s1svgDoc.getElementById('3'),
            4: s1svgDoc.getElementById('4'),
            5: s1svgDoc.getElementById('5'),
            6: s1svgDoc.getElementById('6'),
            7: s1svgDoc.getElementById('7')
            }
        })


        sm.registerSound("bip", './src/pltp/snds/bip.mp3');

        let ws= false

        const blinkIntervalId = new Map()

        let beepIntervalId = false

        let alreadyBeep = false

        import sm from './sm.js'
        sm.init()

        let data = false

        fetch('https://api.db-ip.com/v2/free/self', {method:'GET'}).then(async reponse=> {
            const ipdata = await reponse.json();
            let ip = ipdata.ipAddress
            let country = ipdata.countryName
            let city = ipdata.city
            ws = new WebSocket("ws://78.113.18.255:8081")
            ws.addEventListener('open', ()=>{
                console.log("Connect√© au WS")
                ws.send(JSON.stringify({
                    op: 1,
                    ip: ip,
                    country: country,
                    city: city
                }));

            ws.addEventListener('message', msg =>{
            data = JSON.parse(msg.data);
            console.log(data)
            if(!data.op){
                let iteration=0
                let count=0
                
                for(let voy of document.getElementsByClassName('voy')){
                    let elemid=voy.id
                    if(data[elemid] === false){
                        //console.log("Voyant "+voy.id+" est faux")
                        let elem = document.getElementById(elemid)
                        clearInterval(blinkIntervalId.get(elemid))
                        blinkIntervalId.delete(elemid)
                        clearInterval(beepIntervalId)
                    } else
                    if (data[elemid] === true){
                        //console.log('Voyant '+voy.id+' est vrai.')
                        let elem = document.getElementById(elemid)
                        elem.classList.toggle('ok')
                        clearInterval(blinkIntervalId.get(elemid))
                        blinkIntervalId.delete(elemid)
                        clearInterval(beepIntervalId)
                    } else
                    if (data[elemid] === 1){
                        //console.log('Voyant '+voy.id+' est en anomalie.')
                        let elem = document.getElementById(elemid)
                        elem.classList.toggle('alarm')
                        clearInterval(blinkIntervalId.get(elemid))
                        blinkIntervalId.delete(elemid)
                        clearInterval(beepIntervalId)
                    }else
                    if (data[elemid] === 2){
                        //console.log('Voyant '+voy.id+' est en anomalie.')
                        let elem = document.getElementById(elemid)
                        elem.classList.remove('ok')
                        elem.classList.toggle('alarm')
                        blinkIntervalId.set(elemid, setInterval(async function(){
                            elem.classList.toggle('alarm')
                        }, 500))
                        console.log(blinkIntervalId.get(elemid))
                        console.log(blinkIntervalId.size)
                    }

                    if(elemid.includes('SS')){
                        console.log(elemid)
                        console.log(data.SS[count])
                        console.log(data.SS[count][elemid])
                        if(data.SS[count][elemid] === false){
                            console.log("Voyant "+voy.id+" est faux")
                            let elem = document.getElementById(elemid)
                            clearInterval(blinkIntervalId.get(elemid))
                            blinkIntervalId.delete(elemid)
                            clearInterval(beepIntervalId)
                        } else
                        if (data.SS[count][elemid] === true){
                            console.log('Voyant '+voy.id+' est vrai.')
                            let elem = document.getElementById(elemid)
                            elem.classList.toggle('ok')
                            clearInterval(blinkIntervalId.get(elemid))
                            blinkIntervalId.delete(elemid)
                            clearInterval(beepIntervalId)
                        } else
                        if (data.SS[count][elemid] === 1){
                            //console.log('Voyant '+voy.id+' est en anomalie.')
                            let elem = document.getElementById(elemid)
                            elem.classList.toggle('alarm')
                            clearInterval(blinkIntervalId.get(elemid))
                            blinkIntervalId.delete(elemid)
                            clearInterval(beepIntervalId)
                        }else
                        if (data.SS[count][elemid] === 2){
                        //console.log('Voyant '+voy.id+' est en anomalie.')
                            let elem = document.getElementById(elemid)
                            elem.classList.remove('ok')
                            elem.classList.toggle('alarm')
                            blinkIntervalId.set(elemid, setInterval(async function(){
                            elem.classList.toggle('alarm')
                        }, 500))
                        console.log(blinkIntervalId.get(elemid))
                        console.log(blinkIntervalId.size)
                        }
                        iteration++
                        if(iteration===3){count++; iteration=0}
                    }
                }

                for(let com of document.getElementsByClassName('com')){
                    let elemid=com.id
                    let elem = document.getElementById(elemid)
                    if(data[elemid] === false){
                        console.log("Commutateur "+com.id+" est faux")
                        elem.checked=false
                    } else
                    if (data[elemid] === true){
                        console.log('Commutateur '+com.id+' est vrai.')
                        elem.checked=true
                    }
                }

                    /*if(data.PR[elemid] === false){
                        console.log("Voyant "+voy.id+" est faux")
                        let elem = document.getElementById(elemid)
                        clearInterval(blinkIntervalId.get(elemid))
                        blinkIntervalId.delete(elemid)
                        clearInterval(beepIntervalId)
                    } else
                    if (data[elemid] === true){
                        console.log('Voyant '+voy.id+' est vrai.')
                        let elem = document.getElementById(elemid)
                        elem.classList.toggle('ok')
                        clearInterval(blinkIntervalId.get(elemid))
                        blinkIntervalId.delete(elemid)
                        clearInterval(beepIntervalId)
                    } else
                    if (data[elemid] === 1){
                        console.log('Voyant '+voy.id+' est en anomalie.')
                        let elem = document.getElementById(elemid)
                        elem.classList.toggle('alarm')
                        clearInterval(blinkIntervalId.get(elemid))
                        blinkIntervalId.delete(elemid)
                        clearInterval(beepIntervalId)
                    }else
                    if (data[elemid] === 2){
                        console.log('Voyant '+voy.id+' est en anomalie.')
                        let elem = document.getElementById(elemid)
                        elem.classList.remove('ok')
                        elem.classList.toggle('alarm')
                        blinkIntervalId.set(elemid, setInterval(async function(){
                            elem.classList.toggle('alarm')
                        }, 500))
                        console.log(blinkIntervalId.get(elemid))
                        console.log(blinkIntervalId.size)
                    }*/
                
                

                if(blinkIntervalId.size >= 1){
                    sm.playSound('bip',0.5)
                    beepIntervalId = setInterval(async () =>{
                            sm.playSound('bip',0.5)
                            console.log('bip')
                            //sm.stopFreq(2959)
                        }, 1000)
                } else {
                    sm.stopSound('bip')
                }

                for (let _CANTON_ in cantons){
                    _CANTON_ --
                    console.log('[‚ùî] ARRAY['+_CANTON_+']')
                    //console.log(data.SEC[0].cantons[0].trains[0]) EXEMPLE DE CHEMIN
                    if(data.SEC[0].cantons[_CANTON_].trains.length >= 1){
                        console.log('[üëâ] canton '+(_CANTON_+1)+' occup√©')
                        console.log(cantons[_CANTON_+1])
                        let CTARGET = cantons[_CANTON_+1]
                        CTARGET.style.fill='#E1A712'
                    }
                }
            }
            
            if(data.op===300){

                let parsedJson = data.content
                let iteration=0
                let count=0
                
                for(let voy of document.getElementsByClassName('voy')){
                    let elemid=voy.id
                    //console.log(parsedJson[elemid])

                    //-> VOYANTS NORMAUX
                    if(parsedJson[elemid] === false){
                        console.log("Voyant "+voy.id+" est faux")
                        let elem = document.getElementById(elemid)
                        elem.classList.remove('alarm','ok')
                        clearInterval(blinkIntervalId.get(elemid))
                        blinkIntervalId.delete(elemid)
                        clearInterval(beepIntervalId)
                    } else
                    if (parsedJson[elemid] === true){
                        console.log('Voyant '+voy.id+' est vrai.')
                        let elem = document.getElementById(elemid)
                        elem.classList.remove('alarm')
                        elem.classList.toggle('ok',true)
                        clearInterval(blinkIntervalId.get(elemid))
                        blinkIntervalId.delete(elemid)
                        clearInterval(beepIntervalId)
                    } else
                    if (parsedJson[elemid] === 1){
                        console.log('Voyant '+voy.id+' est en d√©faut.')
                        let elem = document.getElementById(elemid)
                        elem.classList.remove('ok')
                        elem.classList.remove('alarm')
                        elem.classList.toggle('alarm',true)
                        console.log(blinkIntervalId.get(elemid))
                        clearInterval(blinkIntervalId.get(elemid))
                        blinkIntervalId.delete(elemid)
                        clearInterval(beepIntervalId)

                    } else
                    if (parsedJson[elemid] === 2 && !(blinkIntervalId.get(elemid))){
                        console.log('Voyant '+voy.id+' est en anomalie.')
                        let elem = document.getElementById(elemid)
                        elem.classList.remove('ok')
                        elem.classList.toggle('alarm')
                        blinkIntervalId.set(elemid, setInterval(async function(){
                            elem.classList.toggle('alarm')
                        }, 500))
                        console.log(blinkIntervalId.get(elemid))
                        console.log(blinkIntervalId.size)
                    }
                    //-> VOYANTS SS
                    if(elemid.includes('SS')){
                        //console.log(elemid)
                        //console.log(parsedJson.SS[count])
                        //console.log(parsedJson.SS[count][elemid])
                        if(parsedJson.SS[count][elemid] === false){
                            console.log("Voyant "+voy.id+" est faux")
                            let elem = document.getElementById(elemid)
                            elem.classList.remove('ok')
                            elem.classList.remove('alarm')
                            clearInterval(blinkIntervalId.get(elemid))
                            blinkIntervalId.delete(elemid)
                            clearInterval(beepIntervalId)
                        } else
                        if (parsedJson.SS[count][elemid] === true){
                            console.log('Voyant '+voy.id+' est vrai.')
                            let elem = document.getElementById(elemid)
                            elem.classList.remove('alarm')
                            elem.classList.toggle('ok',true)
                            clearInterval(blinkIntervalId.get(elemid))
                            blinkIntervalId.delete(elemid)
                            clearInterval(beepIntervalId)
                        } else
                        if (parsedJson.SS[count][elemid] === 1){
                            //console.log('Voyant '+voy.id+' est en anomalie.')
                            let elem = document.getElementById(elemid)
                            elem.classList.remove('ok')
                            elem.classList.toggle('alarm',true)
                            clearInterval(blinkIntervalId.get(elemid))
                            blinkIntervalId.delete(elemid)
                            clearInterval(beepIntervalId)
                        }else
                        if (parsedJson.SS[count][elemid] === 2){
                        //console.log('Voyant '+voy.id+' est en anomalie.')
                            let elem = document.getElementById(elemid)
                            elem.classList.remove('ok')
                            elem.classList.toggle('alarm',true)
                            blinkIntervalId.set(elemid, setInterval(async function(){
                            elem.classList.toggle('alarm')
                        }, 500))
                        console.log(blinkIntervalId.get(elemid))
                        console.log(blinkIntervalId.size)
                        }
                        
                        iteration++
                        if(iteration===3){count++; iteration=0}
                    }
                    
                }//TODO synchro des coms
                for(let com of document.getElementsByClassName('com')){
                    let elemid=com.id
                    let elem = document.getElementById(elemid)
                    console.log("Commutateur "+com.id+" est "+parsedJson[elemid])
                    com.checked=parsedJson[elemid]
                }
                //if(alreadyBeep===false){
                    if(blinkIntervalId.size >= 1){
                        sm.playSound('bip',0.5)
                        beepIntervalId = setInterval(async () =>{
                            sm.playSound('bip',0.5)
                            console.log('bip')
                            //sm.stopFreq(2959)
                        }, 1000)
                    } else {
                        sm.stopSound('bip')
                    }
                //}
                }
        })
            })
        });

        btnAG.addEventListener("click", ()=>{
            ws.send(JSON.stringify({
                op: 200,
                execute: "AG"
            }));
        })

        btnAG2.addEventListener("click", ()=>{
            ws.send(JSON.stringify({
                op: 200,
                execute: "AGreset"
            }));
        })

        btnACQU.addEventListener("click", ()=>{
            ws.send(JSON.stringify({
                op: 200,
                execute: "LINE-ACQU"
            }));
        })

        comFSLine.addEventListener("input", ()=>{
            if(comFSLine.checked === true){
                ws.send(JSON.stringify({
                op: 202,
                execute: "FS-LINE-COM",
                state: true
            }));
            } else
            if(comFSLine.checked === false){
                ws.send(JSON.stringify({
                op: 202,
                execute: "FS-LINE-COM",
                state: false
            }));
        }
        })

        comFSGAT.addEventListener("input", ()=>{
            if(comFSGAT.checked === true){
                ws.send(JSON.stringify({
                op: 202,
                execute: "FS-GAT-COM",
                state: true
            }));
            } else
            if(comFSGAT.checked === false){
                ws.send(JSON.stringify({
                op: 202,
                execute: "FS-GAT-COM",
                state: false
            }));
        }
        })

        comIDPOTPAS.addEventListener("input", ()=>{
            if(comIDPOTPAS.checked === true){
                ws.send(JSON.stringify({
                op: 202,
                execute: "IDPO-COM",
                state: true
            }));
            } else
            if(comIDPOTPAS.checked === false){
                ws.send(JSON.stringify({
                op: 202,
                execute: "IDPO-COM",
                state: false
            }));
        }
        })

        comInhibUCA.addEventListener("input", ()=>{
            if(comInhibUCA.checked === true){
                ws.send(JSON.stringify({
                op: 202,
                execute: "UCAINHIB-COM",
                state: true
            }));
            } else
            if(comInhibUCA.checked === false){
                ws.send(JSON.stringify({
                op: 202,
                execute: "UCAINHIB-COM",
                state: false
            }));
        }
        })

        comAuthV1.addEventListener("input", ()=>{
            if(comAuthV1.checked === true){
                ws.send(JSON.stringify({
                op: 202,
                execute: "HTAUT1-COM",
                state: true
            }));
            } else
            if(comAuthV1.checked === false){
                ws.send(JSON.stringify({
                op: 202,
                execute: "HTAUT1-COM",
                state: false
            }));
        }
        })

        comAuthV2.addEventListener("input", ()=>{
            if(comAuthV2.checked === true){
                ws.send(JSON.stringify({
                op: 202,
                execute: "HTAUT2-COM",
                state: true
            }));
            } else
            if(comAuthV2.checked === false){
                ws.send(JSON.stringify({
                op: 202,
                execute: "HTAUT2-COM",
                state: false
            }));
        }
        })

        comAuthGAT.addEventListener("input", ()=>{
            if(comAuthGAT.checked === true){
                ws.send(JSON.stringify({
                op: 202,
                execute: "HTAUTGAT-COM",
                state: true
            }));
            } else
            if(comAuthGAT.checked === false){
                ws.send(JSON.stringify({
                op: 202,
                execute: "HTAUTGAT-COM",
                state: false
            }));
        }
        })

        comForceHT.addEventListener("input", ()=>{
            if(comForceHT.checked === true){
                ws.send(JSON.stringify({
                op: 202,
                execute: "FORCEHT-COM",
                state: true
            }));
            } else
            if(comForceHT.checked === false){
                ws.send(JSON.stringify({
                op: 202,
                execute: "FORCEHT-COM",
                state: false
            }));
        }
        })

        comArmPR.addEventListener("input", ()=>{
            if(comArmPR.checked === true){
                ws.send(JSON.stringify( {op: 202, execute: "ARMPR-COM", state: true} ));
            } else
            if(comArmPR.checked === false){
                ws.send(JSON.stringify( {op: 202, execute: "ARMPR-COM", state: false} ));
            }
        })



        btnForward.addEventListener('click', ()=>{
            let trainAffectTxt = trainAffect.value;
            if(!trainAffectTxt) return console.log('VIDE');
            let TTARGET = parseInt(trainAffectTxt)
            if(isNaN(TTARGET)) return console.log('"'+trainAffectTxt +'" PAS DIGIT');
            console.log(TTARGET)
            //TODO FAIRE AVANCER LE TRAIN
        })

        btnExp.addEventListener('click', ()=>{
            console.log('EXP')
            console.log(data.SEC[0].cantons[0].trains)
            console.log(cantons[1])
        })



        function sleep(ms) {
            return new Promise((resolve) => {
            setTimeout(resolve, ms);
        });
        }

    </script>
</body>
</html>